# PasteMark - VSCode 插件需求文档

## 项目概述

PasteMark 是一个 VSCode 插件，用于在 Markdown 文件中快速粘贴剪贴板中的图片。当用户在 Markdown 文件中选中文本并按下快捷键 `Ctrl+Alt+V` 时，插件会自动将剪贴板中的图片保存到当前文件同级目录，并将选中的文本替换为对应的 Markdown 图片语法。

## 技术要求

- **开发语言**: TypeScript
- **运行环境**: WSL2 on Windows
- **目标平台**: Visual Studio Code
- **最小化实现**: 仅包含核心功能，避免不必要的依赖

## 核心功能

### 1. 图片粘贴功能

**触发条件**:
- 用户在 `.md` 文件中选中文本
- 剪贴板中包含图片数据
- 用户按下 `Ctrl+Alt+V` 快捷键

**执行流程**:
1. 检测当前文件是否为 Markdown 文件
2. 获取用户选中的文本
3. 读取剪贴板中的图片数据
4. 生成唯一的图片文件名（如：`image-20250115-122010.png`）
5. 将图片保存到当前 Markdown 文件的同级目录
6. 将选中的文本替换为 `![选中的文本](./图片文件名)`

### 2. 错误处理

- 剪贴板中无图片时提示用户
- 文件保存失败时提示错误信息
- 非 Markdown 文件中使用时提示不支持

## 用户交互

### 快捷键
- `Ctrl+Alt+V`: 粘贴剪贴板图片

### 提示信息
- 成功：显示"图片已保存：[文件名]"
- 失败：显示具体错误原因

## 文件组织

```
当前markdown文件.md
image-20250115-122010.png  # 自动保存的图片
image-20250115-122035.png  # 另一张自动保存的图片
```

## 非功能性需求

1. **性能**: 图片保存和替换操作应在 1 秒内完成
2. **兼容性**: 支持 WSL2 环境下的剪贴板操作
3. **稳定性**: 处理大图片（10MB以内）时不应崩溃
4. **用户体验**: 操作流畅，错误提示清晰

## 实现约束

1. 最小化依赖，仅使用必要的 npm 包
2. 代码简洁，易于维护
3. 遵循 VSCode 插件开发最佳实践
4. TypeScript 严格模式开发

## 未来扩展（本次不实现）

- 支持自定义图片保存路径
- 支持图片格式转换
- 支持拖拽粘贴
- 支持批量处理